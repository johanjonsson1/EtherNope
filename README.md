# EtherNope

**EtherNope** is a vibe coded .NET app that explores native interop with Windows APIs using P/Invoke and Native AOT. Whether you're learning, tinkering, or building utilities for network adapter management, this project demonstrates how modern .NET can compile directly to native machine code and interact seamlessly with the Windows platform by disabling or enabling network interfaces.

## üöÄ Intent

- **"Break internet"** at a time of your choosing. Preferably before the kids should do their bedtime routines.
- **Showcase source generation for P/Invoke:** EtherNope uses P/Invoke to call Win32 SetupAPI and User32 functions for hardware and system control.
  -  [SetupApi documentation](https://learn.microsoft.com/en-us/windows/win32/api/setupapi/)
- **NativeAOT:** Compiles to a single, fast native executable‚Äîno runtime required! Just copy the exe.
- **Experimentation:** Ideal for learning, hacking, or building your own Windows utilities.
- **Task Automation:** Works great as a scheduled task or background tool.

---

## üõ†Ô∏è Building & Publishing (NativeAOT)

You‚Äôll need [.NET 10 SDK](https://dotnet.microsoft.com/download/dotnet) (NativeAOT and LibraryImport is best with .NET 10 Preview).

### **Step 1: Restore, Build and Publish as NativeAOT**

```sh
dotnet restore
dotnet build -c Release
dotnet publish -c Release -r win-x64 --self-contained -p:PublishAot=true
```

**Output:**  
Your native executable will be in `bin\Release\net10.0\win-x64\publish\EtherNope.exe`

---

## ‚ö° Example Use Case: Running via Task Scheduler

You can automate EtherNope to run at startup, on a schedule, or in response to system events.

### **Step 1: Open Windows Task Scheduler**

- Press `Win + R`, type `taskschd.msc`, and hit Enter.

### **Step 2: Create a Basic Task**

1. Name it something clever and provide a description.
2. Add trigger/s for example every weekday 30 mins before your kids' bedtime. :)
3. **Action:** "Start a program"
4. **Program/script:**  
   `C:\Path\To\EtherNope.exe`
5. **Add arguments (optional):**  
   e.g., `disable Ethernet 10 "Internet will be terminated within 15 minutes!"`
6. **Start in (optional):**  

### **Step 3: Edit the task properties**

- Check `run with highest privileges` to interact with the NIC:s

### **Step 4: Finish and Test**

- Run the task manually to ensure it works as expected!

### **Step 5: Create more tasks**
- Create additional tasks for enabling the adapter after 30 minutes or during startup.

---

## ü§ì Sample source generated P/Invoke Code

```csharp
    [LibraryImport("user32.dll", StringMarshalling = StringMarshalling.Utf16)]
    public static partial int MessageBoxW(IntPtr hWnd, string lpText, string lpCaption, uint uType);
```
Turnes into:
```csharp
// <auto-generated/>
namespace EtherNope
{
    public static unsafe partial class Interop
    {
        [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.Interop.LibraryImportGenerator", "10.0.12.45207")]
        [global::System.Runtime.CompilerServices.SkipLocalsInitAttribute]
        public static partial int MessageBoxW(nint hWnd, string lpText, string lpCaption, uint uType)
        {
            int __retVal;
            // Pin - Pin data in preparation for calling the P/Invoke.
            fixed (void* __lpCaption_native = &global::System.Runtime.InteropServices.Marshalling.Utf16StringMarshaller.GetPinnableReference(lpCaption))
            fixed (void* __lpText_native = &global::System.Runtime.InteropServices.Marshalling.Utf16StringMarshaller.GetPinnableReference(lpText))
            {
                __retVal = __PInvoke(hWnd, (ushort*)__lpText_native, (ushort*)__lpCaption_native, uType);
            }

            return __retVal;
            // Local P/Invoke
            [global::System.Runtime.InteropServices.DllImportAttribute("user32.dll", EntryPoint = "MessageBoxW", ExactSpelling = true)]
            static extern unsafe int __PInvoke(nint __hWnd_native, ushort* __lpText_native, ushort* __lpCaption_native, uint __uType_native);
        }
    }
}
```
---
